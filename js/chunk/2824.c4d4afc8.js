"use strict";(self.webpackChunkbalm_ui=self.webpackChunkbalm_ui||[]).push([[2824],{23064:function(e,t,o){o(16573),o(78100),o(77936),o(18111),o(61701),o(37467),o(44732),o(79577),o(47350),o(23241),o(67302),o(55871),o(14603),o(47566),o(98721);const n={ERROR:{NON_IMAGE:1,NOT_PREVIEWABLE:2},tmpFileId(){const e=window.crypto||window.msCrypto;let t=new Uint32Array(8);e.getRandomValues(t);let o="";for(let n=0,l=t.length;n<l;n++)o+=(n<2||n>5?"":"-")+t[n].toString(16).slice(-4);return o},createFileObject(e){let{lastModified:t,name:o,size:l,type:i}=e;return{tmpId:n.tmpFileId(),lastModified:t,name:o,size:l,type:i,sourceFile:e}},getPreviewSrc(e){return new Promise(((t,o)=>{if(e.type.startsWith("image/"))if(window.URL)t(window.URL.createObjectURL(e.sourceFile));else if(window.FileReader){let o=new FileReader;o.onload=function(e){t(e.target.result)},o.readAsDataURL(e.sourceFile)}else o(n.ERROR.NOT_PREVIEWABLE);else o(n.ERROR.NON_IMAGE)}))},async handlePreview(e){e.previewSrc="",e.previewError=0;try{e.previewSrc=await n.getPreviewSrc(e)}catch(t){e.previewError=t}}};t.A=async function(e,t,o){const l=[].slice.call(t.target.files);if(l.length){o(await Promise.all(l.map((async t=>{const o=n.createFileObject(t);return e.preview&&await n.handlePreview(o),Promise.resolve(o)})))),t.target.value=""}}},72824:function(e,t,o){o.d(t,{A:function(){return le}});o(18111),o(7588);var n=o(35720),l=o(32508);let i,r,s={};const a="UiEditor",c=(e={})=>{Object.keys(e).length&&(e.quill?r=e.quill:(i=e.Quill,s=e.toolbarHandlers))},d=()=>({Quill:i,quill:r,toolbarHandlers:s});o(44114),o(81148);const u="ql-emoji";function m(e,t){return t.name&&("emoji"===e?t.value:t.src)}function p(e){return"emoji"===e.type?`:${e.name}:`:`[${e.name}]`}function f(e,t=null){let o,n=function(e,t){let o=t;return t||(o="emoji"===e.type?document.createElement("span"):document.createElement("img")),"emoji"===e.type?(o.innerHTML=e.value,o.style.fontSize="18px"):(o.src=e.src,o.setAttribute("alt",e.alt||"")),o}(e,t);return t||(o=document.createElement("span"),o.classList.add(u,`ql-${e.type}-${e.name}`),o.appendChild(n)),t?n:o}const h=/(:\w+:)|(\[\w+\])/g;let b=[],g={},E={};var y=class{constructor(e){for(let t=0,o=e.length;t<o;t++){const o=e[t];if(b.push({type:o.type,title:o.title}),!o.content.every((e=>m(o.type,e)))){console.warn(`[${a}]`,"Invalid emotions format"),b=[],g={},E={};break}{let e=[];[].slice.call(o.content).forEach((t=>{const n=Object.assign({type:o.type},t),l=p(n);e.push(n),E[l]=n})),g[o.title]=e}}}static getTypes(){return b}static getEmotion(e){return g[e]}static getEmotions(){return E}static clear(){b=[],g={},E={}}static encode(e){const t=(new DOMParser).parseFromString(e,"text/html");return t.querySelectorAll(`.${u}`).forEach((e=>{const t=e.classList[1]?e.classList[1].split("-"):[];if(3===t.length){!function(e,t){if(e.outerHTML)e.outerHTML=t;else{let o=document.createElement("div");o.innerText=t;let n=e.parentNode;n.replaceChild(o,e),n.innerHTML=n.innerHTML.replace(`<div>${t}</div>`,t)}}(e,p({type:t[1],name:t[2]}))}})),t.querySelector("body").innerHTML}static decode(e){let t=e;try{const o=e.match(h);o&&o.forEach((e=>{let o="emoji"===E[e].type?document.createElement("span"):document.createElement("img");o.classList.add(u);const n=f(E[e],o);t=t.replace(e,n.outerHTML)}))}catch(o){console.warn(`[${a}]`,"The param of the 'decodeEmoji' method must be an async data")}return t}};var v=function(){const{Quill:e}=d(),t=e.import("parchment");class o extends t.EmbedBlot{static create(e){let t="emoji"===e.type?document.createElement("span"):document.createElement("img");if("object"===typeof e)return f(e,t);if("string"===typeof e){return f(y.getEmotions()[e],t)}return console.warn(`[${a}]`,"Invalid emoji"),t}}o.blotName="emoji",o.tagName=["SPAN","IMG"],o.className=u,e.register("formats/emoji",o,!0)},j=o(38796);const q="ql-emoji-toolbar",_="ql-emoji-toolbar-close",w={tabBar:"ql-emoji-tab-bar",tabScroller:"ql-emoji-tab-scroller",tabContent:"ql-emoji-tab-content",tab:"ql-emoji-tab",tabActive:"ql-emoji-tab--active",panel:"ql-emoji-panel"};let T=!1;function L(e,t="div"){const o=document.createElement(t);return o.className=e,o}function S(){let e=document.getElementById(q);return e&&e.remove(),e}function k(e){const t=e.target;if(t&&new RegExp(`^${u}`).test(t.classList[0]))e.preventDefault(),e.stopPropagation();else if(T){let e=t;for(;e&&e.classList&&!e.classList.contains("mdc-editor-quill");)if(e=e.parentNode,e&&e.classList&&e.classList.contains("mdc-editor-quill")){e.querySelector("#ql-emoji-toolbar")||S();break}}else S()}var A=function(){const{Quill:e}=d(),t=e.import("core/module");e.register("modules/emoji",class extends t{constructor(e,t){super(e,t),this.quill=e;const o=e.getModule("toolbar");"undefined"!==typeof o&&(o.addHandler("emoji",this.openEmojiToolbar.bind(this)),this.quill.on("selection-change",((e,t,o)=>{if(T=e,T){let e=document.getElementById(q);e&&this.setEmojiToolbarBounds(e)}})))}setEmojiToolbarBounds(e){let t=this.quill.getSelection(!0);if(e&&t){let o=this.quill.getBounds(t.index),n=o.left+240;e.style.top=`${o.top+o.height+10}px`,n>this.quill.container.offsetWidth?e.style.left=o.left-250+"px":e.style.left=`${o.left}px`}}openEmojiToolbar(){if(!S()){const e=document.createElement("div");e.id=q,this.quill.container.appendChild(e),this.setEmojiToolbarBounds(e);const t=document.createElement("i");t.id=_,t.className=j.A.cssClasses.icon,t.innerHTML="close",e.appendChild(t);const o=L(w.tabBar),n=L(w.tabScroller);o.appendChild(n),e.appendChild(o);const l=L(w.panel);e.appendChild(l);const i=y.getTypes();this.addTabs(i,n,l),this.updatePanel(i[0]&&i[0].title,l),this.onEmojiHandler(),this.onCloseHandler()}}addTabs(e,t,o){const n=L(w.tabContent,"ul");t.appendChild(n),e.forEach(((e,t)=>{let l=document.createElement("li");l.classList.add(w.tab),0===t&&l.classList.add(w.tabActive),l.innerHTML=e.title,l.dataset.title=e.title,n.appendChild(l),l.addEventListener(j.A.EVENTS.CLICK,(e=>{let t=e.target;if(!t.classList.contains(w.tabActive)){let e=document.querySelector(`.${w.tabActive}`);e&&e.classList.remove(w.tabActive),t.classList.toggle(w.tabActive),this.updatePanel(t.dataset.title,o)}}))}))}updatePanel(e,t){if(e){t.innerHTML="",y.getEmotion(e).forEach((e=>{const o=f(e);o.setAttribute("title",p(e)),t.appendChild(o)})),this.quill.focus()}else t.innerHTML="Emotions is empty"}onEmojiHandler(){const t=y.getEmotions();document.querySelector(".ql-emoji-panel").addEventListener(j.A.EVENTS.CLICK,(o=>{const n=o.target.parentNode;if(n&&n.classList.contains(u)){let o=this.quill.getSelection(!0);o&&(this.quill.insertEmbed(o.index,"emoji",t[n.title],e.sources.USER),this.quill.setSelection(o.index+1,e.sources.SILENT)),S()}}))}onCloseHandler(){document.getElementById(_).addEventListener(j.A.EVENTS.CLICK,S)}},!0)};var C=function(e){y.getTypes().length||(new y(e),v(),A())};var N=function(){const{Quill:e}=d(),t=e.import("attributors/style/align");e.register(t,!0)};var H=function(){const{Quill:e}=d(),t=e.import("attributors/style/direction");e.register(t,!0)};const x=[1,2,3,4,5,6,7,8].map((e=>`${e}em`));var O=function(){const{Quill:e}=d(),t=e.import("parchment");let o={scope:t.Scope.BLOCK,whitelist:x};class n extends t.Attributor{add(e,t){if("+1"===t||"-1"===t){let o=this.value(e)||0;t="+1"===t?o+1:o-1}return 0===t?(this.remove(e),!0):super.add(e,`${t}em`)}value(e){return parseInt(super.value(e))||void 0}}const l=new n("indent","margin-left",o),i=new n("textindent","text-indent",o);e.register(l,!0),e.register(i,!0)};var I=function(e=[]){if(e.length){const{Quill:t}=d(),o=t.import("attributors/style/font");o.whitelist=e,t.register(o,!0)}};var B=function(e=[]){if(e.length){const{Quill:t}=d(),o=t.import("attributors/style/size");o.whitelist=e,t.register(o,!0)}};var $=function(e=[]){if(e.length){const{Quill:t}=d(),o=t.import("parchment");let n={scope:o.Scope.INLINE,whitelist:e};const l=new o.Attributor("lineheight","line-height",n);t.register(l,!0)}};var R=function(){const{Quill:e}=d(),t=e.import("parchment");class o extends t.EmbedBlot{static create(e){let t=super.create();return"string"===typeof e&&(t.innerHTML=e),t}}o.blotName="html",o.tagName="DIV",e.register("formats/html",o,!0)};var M=function({font:e,size:t,lineheight:o}){N(),H(),O(),I(e),B(t),$(o),R()};const V=`.ql-picker${["header","font","size","lineheight"].map((e=>`:not(.ql-${e})`)).join("")} .ql-picker-label`;function Q(e={}){const t=document.querySelectorAll(".ql-toolbar button"),o=document.querySelectorAll(`.ql-toolbar ${V}`),n=document.querySelectorAll(".ql-toolbar .ql-align .ql-picker-item");if([...t,...o,...n].forEach((e=>{e.classList.add(j.A.cssClasses.icon)})),Object.keys(e).length){const o=document.querySelectorAll(".ql-toolbar .ql-picker");!function(e,t){const o=Object.keys(t);e.forEach((e=>{const n=e.classList[0].replace("ql-","");o.includes(n)&&("object"===typeof t[n]?e.title=t[n][e.value||"default"]:e.title=t[n])}))}([...t,...o],e)}}var P=function(){const{Quill:e}=d();e.register("modules/counter",class{constructor(e,t){this.quill=e,this.options=t,this.container=t.container,e.on("text-change",this.update.bind(this)),this.update()}calculate(){let e=this.quill.getText();return"word"===this.options.unit?(e=e.trim(),e.length>0?e.split(/\s+/).length:0):e.length}update(){let e=this.calculate(),t=this.options.unit||"character";1!==e&&(t+="s"),this.container.innerText=e+" "+t}},!0)};var F=function(){const{toolbarHandlers:e}=d();e.undo=()=>{const{quill:e}=d();e.history.undo()},e.redo=()=>{const{quill:e}=d();e.history.redo()}};var U=function(e){!function(e={}){const{Quill:t}=d(),o=t.import("ui/icons");for(const[n,l]of Object.entries(e))o[n]=l}(e),P(),F()};var z=function(){const{Quill:e}=d(),t=e.import("parchment");class o extends t.EmbedBlot{}o.blotName="divider",o.tagName="HR",e.register("formats/divider",o,!0)};var G=function(){const{Quill:e}=d();e.register("modules/divider",class{constructor(e){this.quill=e;const t=e.getModule("toolbar");"undefined"!==typeof t&&t.addHandler("divider",this.insertHandler.bind(this))}insertHandler(){let t=this.quill.getSelection(!0);t&&(this.quill.insertText(t.index,"\n",e.sources.USER),this.quill.insertEmbed(t.index+1,"divider",!0,e.sources.USER),this.quill.setSelection(t.index+2,e.sources.SILENT))}},!0)};var D=function(){z(),G()};o(61701);var K=function(){const{toolbarHandlers:e}=d();e.linkoff=()=>{const{quill:e}=d();let t=e.getContents().ops.map((e=>(e.attributes&&"undefined"!==typeof e.attributes.link&&delete e.attributes.link,e)));e.setContents(t)}};var W=function(){const{toolbarHandlers:e}=d();e.selectall=()=>{const{quill:e}=d();let t=e.getText();e.setSelection(0,t.length)}};var X=function(){D(),K(),W()};const J=["divider","emoji"];var Y=o(23064),Z=o(62967),ee={EVENTS:{TEXT_CHANGE:"update:modelValue",FILE_CHANGE:"file-change"},BLANK:"<p><br></p>",toolbarIcons:{align:{"":"format_align_left",center:"format_align_center",right:"format_align_right",justify:"format_align_justify"},background:"font_download",blockquote:"format_quote",bold:"format_bold",clean:"format_clear",code:"code",color:"text_format",formula:"functions",italic:"format_italic",image:"insert_photo",indent:{"+1":"format_indent_increase","-1":"format_indent_decrease"},link:"insert_link",list:{ordered:"format_list_numbered",bullet:"format_list_bulleted"},script:{sub:"subscript",super:"superscript"},strike:"strikethrough_s",underline:"format_underlined",video:"videocam",divider:"horizontal_rule",emoji:"insert_emoticon",cut:"content_cut",copy:"content_copy",paste:"content_paste",delete:"clear",search:"search",preview:"preview",selectall:"select_all",fullscreen:{"":"fullscreen",exit:"fullscreen_exit"},undo:"undo",redo:"redo",linkoff:"link_off",textindent:{"+1":"format_indent_increase","-1":"format_indent_decrease"},pdf:"picture_as_pdf"},defaultToolbar:[[{header:[]},{font:[]},{size:[]}],["bold","italic","underline",{color:[]},{background:[]}],[{align:""},{align:"center"},{align:"right"},{align:"justify"}],[{list:"ordered"},{list:"bullet"},{indent:"+1"},{indent:"-1"},"blockquote","emoji"],["link","image","video"],["strike",{script:"super"},{script:"sub"},"divider"],["clean","undo","redo"]]};const te={class:"mdc-editor__content"},oe={key:0,class:"mdc-editor-code",contenteditable:""},ne={name:a,customOptions:{UI_EDITOR:ee}};var le=Object.assign(ne,{props:{modelValue:{type:String,default:""},options:{type:Object,default:()=>({})},toolbar:{type:[Array,String,null],default:null},placeholder:{type:[String,null],default:null},readonly:{type:Boolean,default:!1},fullwidth:{type:Boolean,default:!1},theme:{type:String,default:"snow"},toolbarIcons:{type:Object,default:()=>({})},toolbarTips:{type:Object,default:()=>({})},toolbarOptions:{type:Object,default:()=>({})},toolbarHandlers:{type:Object,default:()=>({})},customImageHandler:{type:Boolean,default:!1},emotions:{type:Array,default:()=>[]},withCounter:{type:Boolean,default:!1},extension:{type:[Boolean,Object],default:!1}},emits:[ee.EVENTS.TEXT_CHANGE,ee.EVENTS.FILE_CHANGE],setup(e,{expose:t,emit:o}){const i=e,r=o,s=(0,n.ref)(null),a=(0,n.ref)(null),u=(0,n.ref)(null),m=(0,n.reactive)({$editor:null,htmlContent:"",editSourceCode:!1}),{htmlContent:p,editSourceCode:f}=(0,n.toRefs)(m),h=(0,n.computed)((()=>({"mdc-editor":!0,"mdc-editor--fullwidth":i.fullwidth})));function b(e,t,o){for(let n of e)"object"===(0,Z.A)(n)&&"array"===(0,Z.A)(n[t])&&0===n[t].length?n[t]=[!1,...o]:"array"===(0,Z.A)(n)&&b(n,t,o)}function g(){let e=i.toolbar;return"array"===(0,Z.A)(e)&&Object.keys(i.toolbarOptions).forEach((t=>{i.toolbarOptions[t].length&&b(e,t,i.toolbarOptions[t])})),"full"===i.toolbar?ee.defaultToolbar:e}function E(e){const{placeholder:t,readonly:o,theme:n}=i,l={modules:{},placeholder:t,readOnly:o,theme:n};let r=Object.assign(l,i.options);r.modules.toolbar={container:g(),handlers:{}},i.withCounter&&(r.modules.counter={container:e});const s=r.modules.toolbar.handlers;return i.customImageHandler&&(s.image=()=>{u.value.click()}),Object.keys(i.toolbarHandlers).forEach((e=>{s[e]=t=>{i.toolbarHandlers[e](m.$editor,t)}})),r}(0,n.onMounted)((()=>{(0,n.nextTick)((async()=>{const{toolbarTips:e,toolbarOptions:t,emotions:o,extension:n}=i;m.$editor=await function(e,{toolbarIcons:t,toolbarTips:o,toolbarOptions:n,options:i,emotions:r,extension:s}){const a=i.modules.toolbar.handlers;c({Quill:l.Ay,toolbarHandlers:a}),J.forEach((e=>{i.modules[e]=!0})),M(n),U(t),X(),"snow"===i.theme?C(r):delete i.modules.emoji,s&&l.Ay.register(s,!0);const d=new l.Ay(e,i);return c({quill:d}),d.insert=(e,t=!0)=>{let o=d.getSelection(!0);o&&(d.insertEmbed(o.index,e,t,l.Ay.sources.USER),d.setSelection(o.index+1,l.Ay.sources.SILENT))},Q(o),d}(s.value,{toolbarIcons:Object.assign(ee.toolbarIcons,i.toolbarIcons),toolbarTips:e,toolbarOptions:t,options:E(a.value),emotions:o,extension:n}),i.modelValue&&j(i.modelValue),m.$editor.on("text-change",((e,t,o)=>{let n=v();n===ee.BLANK&&(n=""),m.htmlContent=n,r(ee.EVENTS.TEXT_CHANGE,n)}))})),(0,n.watch)((()=>i.modelValue),(e=>{e?m.htmlContent!==e&&(j(e),m.$editor.blur()):j()})),(0,n.watch)((()=>i.readonly),(e=>e?m.$editor.disable():m.$editor.enable())),document.addEventListener("click",k)})),(0,n.onBeforeUnmount)((()=>{y.clear(),document.removeEventListener("click",k)}));const v=()=>m.$editor.root.innerHTML,j=(e="")=>{m.$editor.root.innerHTML=e,function(e){i.placeholder&&(i.readonly&&e?m.$editor.root.setAttribute("data-placeholder",""):m.$editor.root.dataset.placeholder||m.$editor.root.setAttribute("data-placeholder",i.placeholder))}(e)},q=e=>m.$editor.insert("image",e);function _(e){(0,Y.A)(i,e,(e=>{r(ee.EVENTS.FILE_CHANGE,e[0],q)}))}return t({useEditor:d,encodeEmoji:e=>y.encode(e),decodeEmoji:e=>y.decode(e)}),(t,o)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(h.value)},[(0,n.renderSlot)(t.$slots,"toolbar"),(0,n.createElementVNode)("div",te,[(0,n.unref)(f)?((0,n.openBlock)(),(0,n.createElementBlock)("pre",oe,(0,n.toDisplayString)((0,n.unref)(p)),1)):((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:1,ref_key:"editor",ref:s,class:"mdc-editor-quill"},null,512))]),e.withCounter?((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:0,ref_key:"counter",ref:a,class:"mdc-editor__counter"},null,512)):(0,n.createCommentVNode)("",!0),e.customImageHandler?((0,n.openBlock)(),(0,n.createElementBlock)("input",{key:1,ref_key:"file",ref:u,type:"file",accept:"image/*",hidden:"",onChange:_},null,544)):(0,n.createCommentVNode)("",!0),(0,n.renderSlot)(t.$slots,"default")],2))}})}}]);